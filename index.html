<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uploading csv/excel files</title>
    
</head>
<body>
    <div class="container">
       <a class="container">
               <input type="file" id="file">
               <button id="submit" name="submit" value="">Upload</button>
               <div class="" id="portrayer"></div>
               <table id="table"></table>
        
    </div>
    
   <script>
        function getFileExtension(filename)
        {
            return filename.split(".").pop().toLowerCase();
        }

        function display()
        {
            let viewer = document.getElementById('portrayer');
            let fileName = document.getElementById("file").value;
            let extension = ["csv","xlsx","xlsm","xlsb","xltx","xltm","xlt","xls","xla","xlw","xlr"];
            let userExtension = getFileExtension(fileName);
            let table = document.getElementById("table");
            let reader = new FileReader(); // create a new FileReader object

            for(let i= 0; i <= extension.length; i++)
            {
                if(userExtension === extension[i])
                {
                    userExtension;
                }else{
                    userExtension;
                }
            }
            if(extension.includes(userExtension))
            {
                file.addEventListener('change',(event) =>{
                const file = event.target.files[0];

                    readXlsx(file).then((rows) => {
                    console.log(rows);
                    table.innerHTML = "";

                        rows.forEach((row) => {
                            const tr = document.createElement('tr');
                            row.forEach((cell) => {
                                const td = document.createElement('td');
                                td.textContent = cell ;
                                tr.appendChild(td);

                            
                            });
                            table.appendChild(tr);
                        });
                    });
                });
                
            }else{
                viewer.textContent = "Incorrect " + userExtension; 
            }
        }
         let butt = document.getElementById("submit");
         butt.addEventListener("click",display);
   </script> 
</body>
</html>